<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medieval Quest</title>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'MedievalSharp', cursive;
            background-color: #1a120b;
            color: #e6d5b8;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #3a2c1a;
            border: 10px solid #8b4513;
            border-radius: 5px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #8b4513;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        h1 {
            color: #d4af37;
            text-shadow: 2px 2px 4px #000;
            margin: 0;
        }
        
        .player-stats {
            display: flex;
            justify-content: space-around;
            background-color: #2a2015;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .stat {
            text-align: center;
            margin: 5px;
            min-width: 80px;
        }
        
        .stat-value {
            color: #d4af37;
            font-weight: bold;
        }
        
        .story-area {
            background-color: #2a2015;
            padding: 20px;
            border-radius: 5px;
            min-height: 150px;
            margin-bottom: 20px;
            border: 1px solid #8b4513;
        }
        
        .choices-area {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .choice-btn {
            background-color: #3a2c1a;
            color: #e6d5b8;
            border: 2px solid #8b4513;
            padding: 12px;
            font-family: 'MedievalSharp', cursive;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
            text-align: left;
        }
        
        .choice-btn:hover {
            background-color: #8b4513;
        }
        
        .choice-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .inventory-area {
            background-color: #2a2015;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #8b4513;
            margin-bottom: 20px;
        }
        
        .inventory-title {
            color: #d4af37;
            margin-top: 0;
            border-bottom: 1px solid #8b4513;
            padding-bottom: 5px;
        }
        
        .inventory-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .inventory-item {
            background-color: #3a2c1a;
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #8b4513;
            cursor: pointer;
        }
        
        .game-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .control-btn {
            background-color: #8b4513;
            color: #fff;
            border: none;
            padding: 10px 20px;
            font-family: 'MedievalSharp', cursive;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .npc-portrait {
            width: 100px;
            height: 100px;
            border: 3px solid #8b4513;
            border-radius: 5px;
            margin: 0 auto 15px;
            background-color: #2a2015;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #d4af37;
        }
        
        .merchant-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px dashed #8b4513;
        }
        
        .merchant-item:last-child {
            border-bottom: none;
        }
        
        .character-creation {
            text-align: center;
        }
        
        .character-option {
            display: inline-block;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .character-option:hover {
            transform: scale(1.05);
        }
        
        .char-portrait {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #2a2015;
            border: 3px solid #d4af37;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }
        
        .char-name-input {
            background: #2a2015;
            border: 2px solid #8b4513;
            color: #e6d5b8;
            padding: 8px;
            font-family: 'MedievalSharp', cursive;
            margin-top: 10px;
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>Medieval Quest</h1>
            <div class="player-stats">
                <div class="stat">
                    <div>Name</div>
                    <div class="stat-value" id="player-name">-</div>
                </div>
                <div class="stat">
                    <div>Gold</div>
                    <div class="stat-value" id="gold">0</div>
                </div>
                <div class="stat">
                    <div>Class</div>
                    <div class="stat-value" id="player-class">-</div>
                </div>
                <div class="stat">
                    <div>Reputation</div>
                    <div class="stat-value" id="reputation">-</div>
                </div>
            </div>
        </div>
        
        <div class="story-area" id="story">
            <p>Loading your adventure...</p>
        </div>
        
        <div class="choices-area" id="choices">
            <!-- Choices will appear here -->
        </div>
        
        <div class="inventory-area">
            <h3 class="inventory-title">Inventory <span id="gold-display">(0 gold)</span></h3>
            <div class="inventory-items" id="inventory">
                <!-- Items will appear here -->
            </div>
        </div>
        
        <div class="game-controls">
            <button class="control-btn" id="save-btn">Save Game</button>
            <button class="control-btn" id="load-btn">Load Game</button>
        </div>
    </div>

    <script>
        // Game Data
        const gameData = {
            currentScene: 'character_creation',
            player: {
                name: "",
                class: "",
                gold: 0,
                reputation: 50,
                inventory: [],
                stats: {
                    strength: 5,
                    agility: 5,
                    intelligence: 5,
                    charisma: 5
                }
            },
            items: {
                health_potion: {
                    id: "health_potion",
                    name: "Health Potion",
                    description: "Restores 20 health",
                    type: "consumable",
                    value: 30
                },
                dagger: {
                    id: "dagger",
                    name: "Iron Dagger",
                    description: "Small but deadly",
                    type: "weapon",
                    value: 50,
                    damage: 5
                },
                cloak: {
                    id: "cloak",
                    name: "Wool Cloak",
                    description: "Provides basic protection",
                    type: "armor",
                    value: 40,
                    defense: 2
                }
            },
            npcs: {
                bartender: {
                    name: "Gareth",
                    portrait: "üç∫",
                    dialogue: {
                        greeting: "'What'll you have?'",
                        options: [
                            {
                                text: "Any work available?",
                                response: "'Aye, I might have something for you...'",
                                nextScene: "bartender_quest"
                            },
                            {
                                text: "Just a drink",
                                response: "'Here you go. That'll be 2 copper.'",
                                effects: { gold: -2 }
                            },
                            {
                                text: "Who hangs around here?",
                                response: "'All sorts. Mercenaries, travelers, the occasional shady character.'"
                            }
                        ]
                    }
                },
                merchant: {
                    name: "Old Thom",
                    portrait: "üí∞",
                    dialogue: {
                        greeting: "'Welcome to my humble shop. What can I do for you?'",
                        options: [
                            {
                                text: "Show me your wares",
                                response: "'Of course! Take a look...'",
                                nextScene: "merchant_shop"
                            },
                            {
                                text: "What's new in town?",
                                response: "'I heard the blacksmith got a shipment of rare metals.'"
                            }
                        ]
                    }
                }
            },
            scenes: {
                character_creation: {
                    text: "<div class='character-creation'><h3>Create Your Character</h3><p>Choose your path:</p></div>",
                    choices: [
                        {
                            text: "<div class='character-option'><div class='char-portrait'>‚öîÔ∏è</div>Warrior (+2 Strength)</div>",
                            nextScene: "name_selection",
                            effects: { class: "Warrior", strength: 2 }
                        },
                        {
                            text: "<div class='character-option'><div class='char-portrait'>üèπ</div>Rogue (+2 Agility)</div>",
                            nextScene: "name_selection",
                            effects: { class: "Rogue", agility: 2 }
                        },
                        {
                            text: "<div class='character-option'><div class='char-portrait'>üîÆ</div>Mage (+2 Intelligence)</div>",
                            nextScene: "name_selection",
                            effects: { class: "Mage", intelligence: 2 }
                        }
                    ]
                },
                name_selection: {
                    text: "<div class='character-creation'><h3>What is your name?</h3><input type='text' id='name-input' class='char-name-input' placeholder='Enter your name'></div>",
                    choices: [
                        {
                            text: "Confirm Name",
                            nextScene: "start",
                            action: "setName"
                        }
                    ]
                },
                start: {
                    text: "You stand in the center of Briarwood village, ready to begin your adventure. The sun shines brightly overhead as villagers go about their business.",
                    choices: [
                        { text: "Visit the tavern", nextScene: "tavern" },
                        { text: "Go to the market square", nextScene: "market_square" },
                        { text: "Check your inventory", nextScene: "inventory_check" }
                    ]
                },
                tavern: {
                    text: "<div class='npc-portrait'>üç∫</div><p>The Rusty Tankard tavern is warm and lively. The bartender notices you enter and waves you over.</p>",
                    choices: [
                        { text: "Talk to the bartender", nextScene: "bartender_talk" },
                        { text: "Look for work", nextScene: "tavern_work" },
                        { text: "Return to village center", nextScene: "start" }
                    ]
                },
                bartender_talk: {
                    text: "<div class='npc-portrait'>üç∫</div><p>The bartender wipes down the counter as you approach.</p><p>'What'll you have?'</p>",
                    choices: [
                        { text: "Any work available?", nextScene: "bartender_quest" },
                        { text: "Just a drink", nextScene: "bartender_drink" },
                        { text: "Never mind", nextScene: "tavern" }
                    ]
                },
                merchant_shop: {
                    text: "<div class='npc-portrait'>üí∞</div><p>'Here's what I have for sale:'</p>" +
                          "<div class='merchant-item'><span>Health Potion</span><span>30 gold</span></div>" +
                          "<div class='merchant-item'><span>Iron Dagger</span><span>50 gold</span></div>" +
                          "<div class='merchant-item'><span>Wool Cloak</span><span>40 gold</span></div>",
                    choices: [
                        { text: "Buy Health Potion (30 gold)", nextScene: "buy_item", action: "buy:health_potion", requires: { gold: 30 } },
                        { text: "Buy Iron Dagger (50 gold)", nextScene: "buy_item", action: "buy:dagger", requires: { gold: 50 } },
                        { text: "Buy Wool Cloak (40 gold)", nextScene: "buy_item", action: "buy:cloak", requires: { gold: 40 } },
                        { text: "Never mind", nextScene: "market_square" }
                    ]
                },
                buy_item: {
                    text: "You make your purchase and the merchant thanks you for your business.",
                    choices: [
                        { text: "Continue shopping", nextScene: "merchant_shop" },
                        { text: "Leave", nextScene: "market_square" }
                    ]
                }
            }
        };

        // Game Functions
        function loadScene(sceneId) {
            const scene = gameData.scenes[sceneId];
            if (!scene) {
                console.error(`Scene ${sceneId} not found!`);
                return;
            }
            
            gameData.currentScene = sceneId;
            document.getElementById('story').innerHTML = scene.text;
            
            const choicesContainer = document.getElementById('choices');
            choicesContainer.innerHTML = '';
            
            if (scene.choices) {
                scene.choices.forEach(choice => {
                    const button = document.createElement('button');
                    button.className = 'choice-btn';
                    button.innerHTML = choice.text;
                    button.onclick = () => makeChoice(choice);
                    
                    if (choice.requires && !hasRequirements(choice.requires)) {
                        button.disabled = true;
                    }
                    
                    choicesContainer.appendChild(button);
                });
            }
            
            if (scene.effects) {
                applyEffects(scene.effects);
            }
            
            updateUI();
        }

        function makeChoice(choice) {
            if (choice.action) {
                handleAction(choice.action);
            }
            
            if (choice.effects) {
                applyEffects(choice.effects);
            }
            
            if (choice.nextScene) {
                loadScene(choice.nextScene);
            } else {
                updateUI();
            }
        }

        function handleAction(action) {
            const [actionType, actionParam] = action.split(':');
            
            switch(actionType) {
                case 'setName':
                    gameData.player.name = document.getElementById('name-input').value;
                    break;
                    
                case 'buy':
                    if (gameData.player.gold >= gameData.items[actionParam].value) {
                        gameData.player.gold -= gameData.items[actionParam].value;
                        gameData.player.inventory.push(actionParam);
                    }
                    break;
                    
                case 'startDialogue':
                    startDialogue(actionParam);
                    break;
            }
        }

        function startDialogue(npcId) {
            const npc = gameData.npcs[npcId];
            let dialogueText = `<div class='npc-portrait'>${npc.portrait}</div><p><b>${npc.name}:</b> ${npc.dialogue.greeting}</p>`;
            
            const choices = npc.dialogue.options.map(option => {
                return {
                    text: option.text,
                    response: option.response,
                    nextScene: option.nextScene || `dialogue_${npcId}`,
                    effects: option.effects
                };
            });
            
            gameData.scenes[`dialogue_${npcId}`] = {
                text: dialogueText,
                choices: choices
            };
            
            loadScene(`dialogue_${npcId}`);
        }

        function applyEffects(effects) {
            if (effects.gold) {
                gameData.player.gold += effects.gold;
            }
            if (effects.reputation) {
                gameData.player.reputation += effects.reputation;
                gameData.player.reputation = Math.max(0, Math.min(100, gameData.player.reputation));
            }
            if (effects.class) {
                gameData.player.class = effects.class;
            }
            if (effects.strength) {
                gameData.player.stats.strength += effects.strength;
            }
            if (effects.agility) {
                gameData.player.stats.agility += effects.agility;
            }
            if (effects.intelligence) {
                gameData.player.stats.intelligence += effects.intelligence;
            }
            if (effects.charisma) {
                gameData.player.stats.charisma += effects.charisma;
            }
            if (effects.addItem) {
                gameData.player.inventory.push(effects.addItem);
            }
            
            updateUI();
        }

        function hasRequirements(requires) {
            for (const [key, value] of Object.entries(requires)) {
                if (key === 'gold' && gameData.player.gold < value) return false;
                if (key in gameData.player.stats && gameData.player.stats[key] < value) return false;
                if (key === 'item' && !gameData.player.inventory.includes(value)) return false;
            }
            return true;
        }

        function updateUI() {
            document.getElementById('player-name').textContent = gameData.player.name || "-";
            document.getElementById('player-class').textContent = gameData.player.class || "-";
            document.getElementById('gold').textContent = gameData.player.gold;
            document.getElementById('gold-display').textContent = `(${gameData.player.gold} gold)`;
            
            let repText;
            if (gameData.player.reputation < 20) repText = "Hated";
            else if (gameData.player.reputation < 40) repText = "Disliked";
            else if (gameData.player.reputation < 60) repText = "Neutral";
            else if (gameData.player.reputation < 80) repText = "Liked";
            else repText = "Revered";
            document.getElementById('reputation').textContent = repText;
            
            const inventoryContainer = document.getElementById('inventory');
            inventoryContainer.innerHTML = '';
            
            gameData.player.inventory.forEach(itemId => {
                const item = gameData.items[itemId];
                if (item) {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'inventory-item';
                    itemElement.textContent = item.name;
                    itemElement.title = item.description;
                    inventoryContainer.appendChild(itemElement);
                }
            });
        }

        function saveGame() {
            localStorage.setItem('medievalQuestSave', JSON.stringify(gameData));
            alert('Game saved!');
        }

        function loadGame() {
            const savedData = localStorage.getItem('medievalQuestSave');
            if (savedData) {
                Object.assign(gameData, JSON.parse(savedData));
                loadScene(gameData.currentScene);
                alert('Game loaded!');
            } else {
                alert('No saved game found!');
            }
        }

        // Initialize the game
        document.getElementById('save-btn').onclick = saveGame;
        document.getElementById('load-btn').onclick = loadGame;
        loadScene(gameData.currentScene);
    </script>
</body>
</html>
